'use strict';(function(d){function r(c,a){function b(){this.constructor=c}y(c,a);c.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)}function D(c,a,b){return a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent("on"+c,b)}function E(c,a,b){return a.removeEventListener?a.removeEventListener(c,b,!1):a.detachEvent("on"+c,b)}function B(c){return"[object Array]"===Object.prototype.toString.call(c)}function v(c,a){return window.getComputedStyle?window.getComputedStyle(a)[c]:a.currentStyle[c]}
function L(c){c.isRendered&&c._callback&&(c._callback(),delete c._callback)}function M(c,a,b){if(c.pop){var e={};d.jL.each(c,function(b,a){e[a]=b});c=e}return d.tokenLib.parseGridTokens(a,c,{cultureName:b})}function N(c,a,b){void 0===b&&(b={});if("object"===typeof a&&(!a.kind||"DataGrid"!==a.kind)){var e=u.find(a);e&&e.destroy()}var f;e=d.jL.getValType(a);var k;"string"===e?f=document.getElementById(a):"object"===e&&(a instanceof Element?f=a:"DataGrid"===a.kind&&(k=a));!k&&f?(a=u.find(f))&&a.element===
f?(k=a,k.options(b)):(a&&a.destroy(),k=new F(f,b)):k&&k.options(b);f=k;f.chart=c;f.setDataFromChart(!0===c.isRendered);return f}function O(c,a){var b=c.currentOptions,e=c._colDefs,f=G(c),k=c.data,g=function(a,f,g,m){var l=e[a],q="string"===typeof l?l:l?l.value:void 0,n=d.jL.getValType(q),p=d.jL.isString(g)&&~g.indexOf("%"),t=g,P=""===t;if("function"===n)t=l.value(g,a,f,k)+"";else if("string"===n||p)"function"===typeof m.replaceTokens?t=m.replaceTokens(q):p?t=d.tokenLib.parseObjectTokens(g,Q(g,d.jL.map(c.column(a),
function(b){return parseFloat(b)||0}))):P||(a=-1<q.indexOf("%"),g=b.summaryRow&&k.length-1===f,a&&!g&&(t=M(k[f],q,b.cultureName)));return h(t,l||{})},h=function(a,e){return"number"===typeof a?"date"===e.type?d.timeLib.dateValid(a)?d.formatting.formatString(d.timeLib.toDate(a),"d",b.cultureName):"#INV":d.formatting.formatString(a,"n"+d.mathLib.decimalPlaces(a),b.cultureName):"undefined"!==a&&d.jL.def(a)?a+"":""},m=k[a],n=[],p=d.jL.getValType(m),l="function"===typeof m.replaceTokens;p=l||"object"!==
p?void 0:Object.keys(m);for(var q=0;q<f;q++)n[q]=g(q,a,l?"":p?m[p[q]]:m[q],m);return n}function R(c){var a=c.currentOptions,b=c._colDefs,e=a.header,f=a.headerRow;a=b.length;var k=[];if(f){if(!e)var g=(c=(c=c.data)&&c[0])&&"object"===typeof c&&!c.pop&&"Point"!==c.kind&&Object.keys(c);c=b.length?Math.max.apply(Math,b.map(function(b){return d.jL.evalPath(b.header,"pop")?b.header.length:b.header?1:0})):0;d.jL.times(Math.max(c,e?1:0,f?1:0),function(b){return k[b]=[]});f=function(a){var c=d.jL.evalPath(b[a],
"header")||d.jL.evalPath(e,a+"")||d.jL.evalPath(g,a+"")||S(a);c&&(c.pop?d.jL.each(c,function(b,e){return k[e][a]=b}):k[0].push(c||""))};for(c=0;c<a;c++)f(c)}return k}function G(c){var a=c.userOptions.columns;c=c.data;var b=function(b){if("function"===typeof b.pop)return b.length;if("object"===typeof b)return Object.keys(b).length};return a&&a.length?a.length:c&&Math.max.apply(Math,c.map(b))||0}function S(c){for(var a=c+1,b="";0<a;)c=(a-1)%26,b=String.fromCharCode(65+c)+b,a=Math.floor((a-c)/26);return b}
function T(c,a){if(!document.getElementById("datagridStyles")){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a||d.platform.getRootScriptPath()+"/resources/datagrid.css");b.setAttribute("id","datagridStyles");b.onload=c;c=document.head.getElementsByTagName("link");c.length?document.head.insertBefore(b,c[0]):document.head.appendChild(b)}}function U(c,a){var b="";d.jL.map(a,function(a){b+='"'+a.join('","')+'"\n'});var e=
new Blob([b],{type:"text/csv;charset=utf-8;"});navigator.msSaveBlob?navigator.msSaveBlob(e,c):(a=document.createElement("a"),void 0!==a.download&&(e=URL.createObjectURL(e),a.setAttribute("href",e),a.setAttribute("download",c),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)))}function V(c,a,b){var e=c.renderer.renderer;a=d.jL.isString(a)?d.platform.doc.getElementById(a):a;var f=e.element("div",{className:"chartGridSwitch"}),k=e.element("button",{className:"chartButton",
innerHTML:b.buttonText("chart")||"Chart"}).add(f),g=e.element("button",{className:"gridButton",innerHTML:b.buttonText("grid")||"Grid"}).add(f),h=b.wrapper,m=c.renderer.renderer.wrapper,n=c.renderer.renderer.root,p=c.renderer.renderer.container;a.insertBefore(f.el,a.childNodes[0]);h.attr({display:"none"});g.on("click",function(){"100%"!==n.attr("height")||p.attr("height")||n.attr({height:"350px"});m.attr({display:"none"});h.attr({display:"block"});k.attr({backgroundColor:"#f5f5f5"});g.attr({backgroundColor:"#d5d5d5"})});
k.on("click",function(){m.attr({display:"block"});h.attr({display:"none"});k.attr({backgroundColor:"#d5d5d5"});g.attr({backgroundColor:"#f5f5f5"})});f.buttons={chart:k,grid:g};return f}function Q(c,a){c=c.match(W);var b={};if(!c)return b;c.forEach(function(e){b[e.slice(1)]=d.dataUtil.calculations(a,e.slice(1))||e});return b}var y=function(c,a){y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var e in a)a.hasOwnProperty(e)&&(b[e]=a[e])};return y(c,
a)},I=function(){for(var c=3,a=document.createElement("b"),b=a.all||[];a.innerHTML="\x3c!--[if gt IE "+ ++c+"]><i><![endif]--\x3e",b[0];);return 4<c?c:document.documentMode},C=function(c){var a=navigator.platform.toLowerCase().indexOf("mac")+1,b=this,e={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:"clusterize-no-data",no_data_text:"No data",keep_parity:!0,callbacks:{}};b.options={};for(var f="rows_in_block blocks_in_cluster show_no_data_row no_data_class no_data_text keep_parity tag callbacks".split(" "),
d=0,g;g=f[d];d++)b.options[g]="undefined"!=typeof c[g]&&null!=c[g]?c[g]:e[g];e=["scroll","content"];for(d=0;f=e[d];d++)if(b[f+"_elem"]=c[f+"Id"]?document.getElementById(c[f+"Id"]):c[f+"Elem"],!b[f+"_elem"])throw Error("Error! Could not find "+f+" element");b.content_elem.hasAttribute("tabindex")||b.content_elem.setAttribute("tabindex",0);var h=B(c.rows)?c.rows:b.fetchMarkup(),m={};c=b.scroll_elem.scrollTop;b.insertToDOM(h,m);b.scroll_elem.scrollTop=c;var n=!1,p=0,l=!1,q=function(){a&&(l||(b.content_elem.style.pointerEvents=
"none"),l=!0,clearTimeout(p),p=setTimeout(function(){b.content_elem.style.pointerEvents="auto";l=!1},50));n!=(n=b.getClusterNum())&&b.insertToDOM(h,m);b.options.callbacks.scrollingProgress&&b.options.callbacks.scrollingProgress(b.getScrollProgress())},r=0,H=function(){clearTimeout(r);r=setTimeout(b.refresh,100)};D("scroll",b.scroll_elem,q);D("resize",window,H);b.destroy=function(a){E("scroll",b.scroll_elem,q);E("resize",window,H);b.html((a?b.generateEmptyRow():h).join(""))};b.refresh=function(a){(b.getRowsHeight(h)||
a)&&b.update(h)};b.update=function(a){h=B(a)?a:[];a=b.scroll_elem.scrollTop;h.length*b.options.item_height<a&&(n=b.scroll_elem.scrollTop=0);b.insertToDOM(h,m);b.scroll_elem.scrollTop=a};b.clear=function(){b.update([])};b.getRowsAmount=function(){return h.length};b.getScrollProgress=function(){return this.options.scroll_top/(h.length*this.options.item_height)*100||0};var z=function(a,e){e=B(e)?e:[];e.length&&(h="append"==a?h.concat(e):e.concat(h),b.insertToDOM(h,m))};b.append=function(b){z("append",
b)};b.prepend=function(b){z("prepend",b)}};C.prototype={constructor:C,fetchMarkup:function(){for(var c=[],a=this.getChildNodes(this.content_elem);a.length;)c.push(a.shift().outerHTML);return c},exploreEnvironment:function(c,a){var b=this.options,e=I();b.content_tag=this.content_elem.tagName.toLowerCase();c.length&&(e&&9>=e&&!b.tag&&(b.tag=c[0].match(/<([^>\s/]*)/)[1].toLowerCase()),1>=this.content_elem.children.length&&(a.data=this.html(c[0]+c[0]+c[0])),b.tag||(b.tag=this.content_elem.children[0].tagName.toLowerCase()),
this.getRowsHeight(c))},getRowsHeight:function(c){var a=this.options,b=a.item_height;a.cluster_height=0;if(c.length&&(c=this.content_elem.children,c.length)){var e=c[Math.floor(c.length/2)];a.item_height=e.offsetHeight;"tr"==a.tag&&"collapse"!=v("borderCollapse",this.content_elem)&&(a.item_height+=parseInt(v("borderSpacing",this.content_elem),10)||0);"tr"!=a.tag&&(c=parseInt(v("marginTop",e),10)||0,e=parseInt(v("marginBottom",e),10)||0,a.item_height+=Math.max(c,e));a.block_height=a.item_height*a.rows_in_block;
a.rows_in_cluster=a.blocks_in_cluster*a.rows_in_block;a.cluster_height=a.blocks_in_cluster*a.block_height;return b!=a.item_height}},getClusterNum:function(){this.options.scroll_top=this.scroll_elem.scrollTop;return Math.floor(this.options.scroll_top/(this.options.cluster_height-this.options.block_height))||0},generateEmptyRow:function(){var c=this.options;if(!c.tag||!c.show_no_data_row)return[];var a=document.createElement(c.tag),b=document.createTextNode(c.no_data_text);a.className=c.no_data_class;
if("tr"==c.tag){var e=document.createElement("td");e.colSpan=100;e.appendChild(b)}a.appendChild(e||b);return[a.outerHTML]},generate:function(c,a){var b=this.options,e=c.length;if(e<b.rows_in_block)return{top_offset:0,bottom_offset:0,rows_above:0,rows:e?c:this.generateEmptyRow()};var f=Math.max((b.rows_in_cluster-b.rows_in_block)*a,0);a=f+b.rows_in_cluster;var d=Math.max(f*b.item_height,0);b=Math.max((e-a)*b.item_height,0);e=[];var g=f;for(1>d&&g++;f<a;f++)c[f]&&e.push(c[f]);return{top_offset:d,bottom_offset:b,
rows_above:g,rows:e}},renderExtraTag:function(c,a){var b=document.createElement(this.options.tag);b.className=["clusterize-extra-row","clusterize-"+c].join(" ");a&&(b.style.height=a+"px");return b.outerHTML},insertToDOM:function(c,a){this.options.cluster_height||this.exploreEnvironment(c,a);c=this.generate(c,this.getClusterNum());var b=c.rows.join(""),e=this.checkChanges("data",b,a),f=this.checkChanges("top",c.top_offset,a);a=this.checkChanges("bottom",c.bottom_offset,a);var d=this.options.callbacks,
g=[];e||f?(c.top_offset&&(this.options.keep_parity&&g.push(this.renderExtraTag("keep-parity")),g.push(this.renderExtraTag("top-space",c.top_offset))),g.push(b),c.bottom_offset&&g.push(this.renderExtraTag("bottom-space",c.bottom_offset)),d.clusterWillChange&&d.clusterWillChange(),this.html(g.join("")),"ol"==this.options.content_tag&&this.content_elem.setAttribute("start",c.rows_above),this.content_elem.style["counter-increment"]="clusterize-counter "+(c.rows_above-1),d.clusterChanged&&d.clusterChanged()):
a&&(this.content_elem.lastChild.style.height=c.bottom_offset+"px")},html:function(c){var a=this.content_elem,b=I();if(b&&9>=b&&"tr"==this.options.tag){b=document.createElement("div");for(b.innerHTML="<table><tbody>"+c+"</tbody></table>";c=a.lastChild;)a.removeChild(c);for(c=this.getChildNodes(b.firstChild.firstChild);c.length;)a.appendChild(c.shift())}else a.innerHTML=c},getChildNodes:function(c){c=c.children;for(var a=[],b=0,e=c.length;b<e;b++)a.push(c[b]);return a},checkChanges:function(c,a,b){var e=
a!=b[c];b[c]=a;return e}};var J=function(){function c(a,b,e){void 0===e&&(e=[]);this.currentOptions={};this.userOptions={};this.chart=a;if(void 0===b){var c=1;b={}}b=this.normalizeOptions(b);this.userOptions=d.jsLib.clone(b);this.renderer=a&&(a.renderer||a);this.init.apply(this,e);!c&&this.setOptions()}c.prototype.options=function(a,b){if("string"===typeof a)return this.optionsGet(a);d.jsLib.merge(this.userOptions,this.normalizeOptions(a));this.setOptions();return this};c.prototype.init=function(){for(var a=
0;a<arguments.length;a++);this.defaultMutable=!0};c.prototype.normalizeOptions=function(a,b){return d.jsLib.expandOptionsProperties(a,b)};c.prototype.optionsGetter=function(a){return w._optionsGetter(this,a)};c.prototype.optionsGet=function(a){return w._optionsGet(this,a)};c._optionsGetter=function(a,b){var e=d.jsLib.getValType(b);a=a.currentOptions;return"undefined"===e?a:"string"===e?d.jsLib.evalPath(a,b.replace(/_/g,".")):"NotGetter"};c._optionsGet=function(a,b){return d.jsLib.evalPath(a.currentOptions,
b.replace(/_/g,"."))};c.prototype.defaultOptions=function(){return{}};c.prototype.contextOptions=function(){return this.defaultContextOptions};c.prototype.setOptions=function(){var a=[this.defaultOptions()],b=this.contextOptions();b&&a.push(b);a.push(this.userOptions);!this.defaultMutable&&a.unshift({});this.currentOptions=d.jsLib.merge.apply(d.jsLib,a);return this};return c}(),w=function(c){function a(b,a,f){void 0===f&&(f=[]);b=c.call(this,b,a,f)||this;b.attribs={};b.events={};b.updateOptions={};
b.subscriptions=[];return b}r(a,c);a.prototype.init=function(){for(var b=0;b<arguments.length;b++);this.defaultMutable=!0};a.prototype.defaultOptions=function(){return this.chart?{animation:this.chart.options("animation")}:{}};a.prototype.setOptions=function(){c.prototype.setOptions.call(this);this.setRootVisuals();return this};a.prototype.options=function(b,a){var e=this.optionsGetter(b);if("NotGetter"!==e)return e;d.jsLib.merge(this.userOptions,this.normalizeOptions(b));this.setOptions();!1!==a&&
this.render(null,a);return this};a.prototype.normalizeUpdateOpt=function(b,a){"object"===typeof a?(b=d.jsLib.cloneDeep(b),a=d.jsLib.merge(b,a)):a=b;return a};a.prototype.setRootVisuals=function(){this.rootPanel||(this.rootPanel=this.renderer.panel());return this};a.prototype.setAttribs=function(){return this};a.prototype.render=function(b,a){return this};a.prototype.getBounds=function(b){var a=b||this.rootPanel,c=a;for(b=[0,0];c;)b[0]+=c.x.px+c.offsetX,b[1]+=c.y.px+c.offsetY,c=c.parent;a.isPatched?
(a=a.getBbox(),a=[a.width,a.height]):(c=a.combinations,c.length||(c=a.composeCombinations()),c=c[0],a=[d.jsLib.pick(d.jsLib.evalPath(a.attrs,"width"),c.minSize.width.px),d.jsLib.pick(d.jsLib.evalPath(a.attrs,"height"),c.minSize.height.px)]);return b.concat(a)};a.prototype.add=function(b,a){this.parentLayoutItem=b||this.renderer;this.render();this.rootPanel.add(b,a);return this};a.prototype.destroy=function(){d.jsLib.each(this.rootVisuals,function(b){return b&&b.destroy&&b.destroy()});this.rootPanel&&
this.rootPanel.destroy()};a.prototype.handleEvent=function(b,a,c,k){if(d.jsLib.isDefined(a)&&d.jsLib.isDefined(c)&&(a=this.events[a]))return a[b](c,k)};a.prototype.trigger=function(b,a){this.events[b].trigger(a,this)};a.prototype.on=function(b,a,c){(b=this.handleEvent(c?"onDefer":"on",b,a,c))&&this.subscriptions.push(b);return this};a.prototype.un=function(b,a){this.handleEvent("un",b,a);return this};a.prototype.triggerUser=function(b,a){return this.triggerUserTarget(b,this,a)};a.prototype.triggerUserTarget=
function(b,a,c){b=d.jsLib.evalPath(this.currentOptions,"events."+b);if("function"===typeof b)return b.call(a,c||d.undefVal)};a.prototype.hasUserEvent=function(b){var a;if("any"===b&&(a=d.jsLib.evalPath(this.currentOptions,"events"))&&d.jsLib.keys(a).length)return!0;a=d.jsLib.evalPath(this.currentOptions,"events."+b);if("function"===typeof a)return!0};a.prototype.hasAnyNamedEvent=function(b){return this.hasUserEvent(b)||this.events[b]};a.prototype.click=function(b){};return a}(J),x=function(c){function a(b,
a,f){void 0===f&&(f=[]);f=c.call(this,b,a,f)||this;f.chart=b;void 0===a&&(a={});f.id=a.id||d.undefVal;f.ciManager=b.chartItemManager;f.ciManager.register(f);return f}r(a,c);a.prototype.destroy=function(){c.prototype.destroy.call(this);this.ciManager.remove(this)};return a}(w),X=d.jsLib.plainArray("rotate fontFamily fontStyle fontWeight fontSize color margin padding".split(" ")),Y=d.jsLib.plainArray(["val","xAlignment","yAlignment"]);(function(c){function a(b,a,f){b=c.call(this,b,a)||this;b.target=
f;b.currentState=d.itemStates.normal;return b}r(a,c);a.prototype.setRootVisuals=function(){var b=this.rootVisuals=this.rootVisuals||{},a=this.rootPanel,c=this.renderer;this.rootPanel||(a=this.rootPanel=c.panel());b.background||(b.background=b.background||c.item({type:"rect",fill:"transparent"}).add(a));b.text||(b.text=b.text||c.textStack(this.getText()).attr({width:"auto",autoWrap:"none"}).add(a));return this};a.prototype.setAttribs=function(){var b,a={};a[d.itemStates.normal]=this.translate(this.currentOptions);
if(b=this.currentOptions.states)b[d.itemStates.hover]&&(a[d.itemStates.hover]=this.translate(d.jsLib.evalPath(this.currentOptions,"states.hover"))),b[d.itemStates.selected]&&(a[d.itemStates.selected]=this.translate(d.jsLib.evalPath(this.currentOptions,"states.selected")));this.attribs=a;return this};a.prototype.applyAttrs=function(b){this.rootPanel.attr(d.jsLib.exclude(b,Y));this.rootVisuals.text.attr(d.jsLib.exclude(b,X));this.chart.triggerOptionsApplied("label",this)};a.prototype.isVisible=function(){return!1!==
this.currentOptions.visible&&this.getText().length};a.prototype.getSize=function(b){if(!this.isVisible())return[0,0];b&&this.applyAttrs(b);this.rootPanel.updateCombinations();var a=this.rootPanel.combinations;b=this.rootPanel.calculateMargin();if(!a.length)return[0,0];a=a[0].minSize;return[a.width.px+b.horizontal.px,a.height.px+b.vertical.px]};a.prototype.getSizes=function(b){if(!this.isVisible())return[[0,0]];b&&this.applyAttrs(b);this.rootPanel.updateCombinations();b=this.rootPanel.combinations;
var a=this.rootPanel.calculateMargin();a=[a.horizontal.px,a.vertical.px];return b.length?d.jsLib.map(b,function(b){b=b.minSize;return[b.width.px+a[0],b.height.px+a[1]]}):[[0,0]]};a.prototype.render=function(){var b=this;this.setOptions();this.setAttribs();var a=this.currentOptions,c=this.attribs[d.itemStates.normal],k=c.attr.label;c=c.layout.label;var g=this.rootVisuals.text;if(this.isVisible()){this.rootPanel&&this.rootPanel.visible(!0);this.applyAttrs(c);var h=this.rootVisuals.text.variant;90===
Math.abs(c.rotate)&&"center"===c.yAlignment&&h&&g.attr({y:h.minSize.width.px/2*(0>c.rotate?1:-1)});g&&(g.attr(k),g.attr({val:this.getText()}),d.jsLib.evalPath(a,"states.hover")&&((void 0).on("mouseover",function(){b.setState(d.itemStates.hover)}),(void 0).on("mouseout",function(){b.setState(d.itemStates.normal)})))}else this.rootPanel&&this.rootPanel.visible(!1);return this};a.prototype.translate=function(b){var a={},c={};b=b||this.currentOptions;c=d.jsLib.defaults({},b.style||{});d.jsLib.applySetting(a,
b,function(b,a){b.color=a},"color",d.colorLib.parseJscColor);c=d.stylingLib.labelToAttr(this.currentOptions);return{attr:{label:a},layout:{label:c}}};a.prototype.setState=function(b){if(b!==this.currentState){var a=this.attribs[b],c=a.attr.label;this.rootPanel.options(a.layout.label);this.rootPanel.attr(c);this.currentState=b}};a.prototype.attr=function(b){this.rootPanel.attr(b)};a.prototype.getTextEl=function(){return this.rootVisuals.text};a.prototype.getText=function(){return this.evalText(this.options("text"))||
""};a.prototype.evalText=function(b){var a=this.target||this.chart;b&&a&&a.replaceTokens&&(b=a.replaceTokens(b));return b};return a})(w);var Z="visible fill outline opacity radius padding position margin corners shadow width height".split(" "),aa=function(c){c=c?c.boxDefaults():d.consts.boxDefaults();c.fill=d.colorLib.addOpacity(c.fill,.8);c.position="bltl";return c};(function(c){function a(b,a){a=c.call(this,b.chart,a,b)||this;a.chartArea=b;a.fillShading="titleBox";return a}r(a,c);a.prototype.applyOptions=
function(){var b=this.currentOptions;if(!1===b.visible)return this.rootPanel.attr({suspend:"true"}),this;c.prototype.applyOptions.call(this);if(b=d.jsLib.evalPath(b,"position"))"full"===b?this.rootPanel.attr({width:"100%",strategy:"none"}):this.rootPanel.attr({width:"auto"});return this};a.prototype.triggerOptionsApplied=function(){this.chart.triggerOptionsApplied("title",this)};a.prototype.defaultOptions=function(){var b=this.chart;b=b?b.boxDefaults():d.consts.boxDefaults();return d.jsLib.merge(b,
{position:"left",corners:["cut","square","square","square"],label:{align:"left",style:{fontWeight:"bold"}},animation:!1,shadow:!0})};a.prototype.setRootVisuals=function(){c.prototype.setRootVisuals.call(this);this.rootPanel.attr({transition:!1});return this};a.prototype.createContentVisual=function(b){return this.renderer.textStack().add(b)};return a})(function(c){function a(b,a,f){b=c.call(this,b,a,[b,a,f])||this;b.target=f;b.fillShading="box";b.asHTML=!1;b.isVisible=!1;b.applyOptions(!1);return b}
r(a,c);a.prototype.init=function(){for(var b=0;b<arguments.length;b++);};a.prototype.defaultOptions=function(){var b=d.jsLib.evalPath(this.chart.currentOptions,"defaultAnnotation");return d.jsLib.merge(aa(this.chart),b)};a.prototype.setRootVisuals=function(){var b=this,a=this.renderer;this.rootPanel||(a=this.rootPanel=this.rootPanel||(this.asHTML||this.currentOptions.asHTML?a.renderer.htmlElement().attr({left:0,top:0}):a.box({autoWrap:"none",transition:{auto:!0,animation:d.jsLib.def(this.currentOptions.animation)?
this.currentOptions.animation:{duration:1200}}})),this.rootVisuals||(this.rootVisuals={content:this.createContentVisual(a)}),a.on("click",function(a){return b.click(a)}));return this};a.prototype.getBounds=function(b){return!b&&this.currentOptions.asHTML?this.bbox():c.prototype.getBounds.call(this,b)};a.prototype.createContentVisual=function(b){if(!this.asHTML&&!this.currentOptions.asHTML)return this.renderer.textStack().add(b)};a.prototype.bbox=function(b){var a=this.rootPanel,c=a.getBbox();this.currentOptions.asHTML&&
(b=b?d.jsLib.parseMargin(this.currentOptions.margin):[0,0,0,0],c.x=(parseFloat(a.attr("left"))||0)-b[3],c.y=(parseFloat(a.attr("top"))||0)-b[0],c.width=c.width+b[1]+b[3],c.height=c.height+b[0]+b[2]);return[c.x,c.y,c.width,c.height]};a.prototype.visible=function(b){d.jsLib.isDefined(b)||(b="none"!==this.rootPanel.attr("display"));this.rootPanel.attr({display:b?"block":"none"});this.setVisible(b);return this};a.prototype.setVisible=function(b){this.isVisible=b};a.prototype.alignTo=function(){for(var b=
[],a=0;a<arguments.length;a++)b[a]=arguments[a];var c;(c=this.rootPanel).alignTo.apply(c,b)};a.prototype.options=function(b,a){var c=this.optionsGetter(b);if("NotGetter"!==c)return c;c=this.normalizeOptions(b);var e=this.userOptions.label,g=c.label&&c.label.text;e=e&&e.text;g=d.jsLib.isDefined(g)&&e!==g;if(!d.jsLib.changesWithExtend(this.userOptions,c))return this;this.setOptions();c=d.jsLib.def(a);this.applyOptions(c?a:{skipReflow:!0});if(!1===a||c&&a.skipReflow)return this;g=(c=this.rootPanel)&&
c.isPatched&&(g||void 0);!g&&c&&this.chart.isRendered&&!1!==a&&(b=d.jsLib.keys(b),0<d.jsLib.intersection(b,Z).length&&(g=!0));g&&(d.cachedPositionInfo(this)[0]?c.refresh&&c.refresh():this.chart.chartAreaSet.reflow(a,!1,!0));return this};a.prototype.normalizeOptions=function(b){d.normalizationUtils.arrayifyCorners(b);return c.prototype.normalizeOptions.call(this,b)};a.prototype.applyOptions=function(b){void 0===b&&(b={});this.rootPanel||this.setOptions();var a=this.currentOptions,c=this.rootPanel,
k=this.rootVisuals.content,g=this.asHTML||a.asHTML,h=d.jsLib.clone(d.jsLib.pick(b.animation,a.animation,{}));b=d.jsLib.clone(a);var m=d.stylingLib.labelToAttr(a.label),n=d.jsLib.evalPath(a,"label.text");if(g){var p=this.rootPanel,l=p.transition(),q=p.renderer.isAnimationDisabled(b);b.animation=p.isPatched&&!q?l?d.jsLib.merge(l.getAnimationOptions(),h):h:null;b=d.stylingLib.annotationToHtmlAttr(b)}else b=d.stylingLib.boxToLayoutBoxAttr(b,d.jsLib.pick(a.fillShading,this.fillShading)),b.animation=h;
if((n=this.evalText(n))||!this.asHTML&&k&&k.textAttr!==n||this.asHTML&&c.innerHTML!==n)m=d.jsLib.merge({animation:{duration:0}},m),this.asHTML||a.asHTML?b.innerHTML=n:m.val=n,k&&k.attr(m);this.checkVisibility(a);if(a=d.updatePosition(this))b[g?"left":"offsetX"]=g?a[0]+"px":a[0],b[g?"top":"offsetY"]=g?a[1]+"px":a[1];c.attr(this.transformAttr(b));this.triggerOptionsApplied();return this};a.prototype.triggerOptionsApplied=function(){this.chart.triggerOptionsApplied("annotation",this)};a.prototype.transformAttr=
function(b){return b};a.prototype.checkVisibility=function(b){b=!1!==b.visible;var a=this.rootPanel?"none"!==this.rootPanel.attr("display"):this.isVisible,c=b!==a;this.setVisible(a);c&&this.visible(b)};a.prototype.destroy=function(){c.prototype.destroy.call(this);this._unsubscribeContentBox&&this._unsubscribeContentBox();this.rootPanel&&this.rootPanel.destroy()};a.prototype.measure=function(b){this.isMeasured=!0;b&&!this.currentOptions.maxWidth&&this.rootPanel.attr({maxWidth:b[2]});return this.rootPanel?
this.rootPanel.isHtml?d.bboxLib.fromRect(this.bbox(!0)):this.rootPanel.setPreliminarySize(!0).getGlobalBboxArray(!0):[0,0,0,0]};a.prototype.positionApplied=function(b){};a.prototype.positionUpdated=function(b){this.positionApplied(b)};a.prototype.getText=function(){};a.prototype.evalText=function(b){var a=this.target||this.chart;a&&a.replaceTokens&&"string"===typeof b&&-1<b.indexOf("%")&&(b=a.replaceTokens(b));return b};return a}(x));x=function(c){function a(){var b=null!==c&&c.apply(this,arguments)||
this;b.kind="RangeValueEntry";return b}r(a,c);a.prototype.replaceTokens=function(b,a){return d.tokenLib.parseRangeValueTokens(b,this,a||this.getFormatInfo())};return a}(function(c){function a(){var b=null!==c&&c.apply(this,arguments)||this;b.kind="EntryWrapper";return b}r(a,c);a.prototype.defaultOptions=function(){return{}};a.prototype.styleIconVisual=function(b,a){if(b){b=b.base;var c=d.jsLib.merge({},this.currentOptions),e=d.jsLib.evalPath(c,"outline.color");d.jsLib.setPathVal(c,"outline.color",
e||d.colorLib.modifyColor("outline",c.color||"white"));c=d.stylingLib.shapeToAttr(c);b&&b.attr(c);a.isStyled=!0}};a.prototype.getIconVisual=function(b,a,c){void 0===c&&(c={});a=this.renderer;var d=c.root=c.root||a.panel({yAlignment:"center"});b=this.getIconPaths(b);b.base&&!c.base&&(c.base=c.base||a.renderer.path({d:b.base}).add(d));return c};a.prototype.getIconPaths=function(b){return{base:d.shapes.square(0,0,b[0],b[1]),extra:d.undefVal}};a.prototype.setState=function(b){};a.prototype.replaceTokens=
function(b,a){return this.chart.replaceTokens(b,a)};a.prototype.getFormatInfo=function(){return this.chart.getFormatInfo()};return a}(x));d.jsLib.extend(d.en.error.general,{spRangesOverflow:"Maximum smartPalette ranges exceeded by %% setting."});(function(c){function a(){var b=null!==c&&c.apply(this,arguments)||this;b.kind="SmartPaletteEntry";return b}r(a,c);return a})(x);var ba={date:"left",number:"right",string:"left"},W=/%[a-z]+/g,u=new (function(){function c(){this.byID={}}c.prototype.add=function(a,
b){this.byID[b.id]=a};c.prototype.remove=function(a){delete this.byID[a.element.id]};c.prototype.find=function(a){return this.byID[a.id]};return c}()),F=function(c){function a(b,a,f){var e=c.call(this,null,a)||this;e.element=b;e.kind="DataGrid";e.rowsStrings=[];e.scrollHandler=function(b){e.scroll(b)};var g=a||{};"string"===typeof b&&(e.element=document.getElementById(b));e.register();e.initFP();e.data=a?e.dataRows(a):[];e.renderer=d.rendererFactory.create({noRender:!0});e.prerender();f&&(e._callback=
function(){return f(e)});e.element.style.height&&(g.height=g.height||"100%");e.options(g);document.getElementById("datagridStyleDefault")||(e.renderer.cssText("\n.jscGrid table{\n\tfont-family:Helvetica;\n\tfont-size:12px;\n\tborder-collapse: separate;\n\tborder-spacing: 0;\n\twidth: 100%;\n\tcursor: default;\t\n}\n\n.jscGrid table tbody tr:nth-child(2n+1){\n\tbackground:#F5F5F5;\n}\n\n.jscGrid table thead th{\n\tbackground:#0277BD;\n\tcolor:white;\n}\n\n.jscGrid table th{\n\tbackground:#E0E0E0;\n\tfont-weight:normal;\n\tcolor:#424242;\n\tpadding:5px;\n\tborder-right: 1px solid white;\n\tborder-bottom: 1px solid white;\n}\n\n.jscGrid table td{\n\tborder-right: 1px solid #F5F5F5;\n\tpadding: 5px;\n\tvertical-align: top;\n\toverflow: hidden;\n\twhite-space: pre-line;\n\tbackground-clip: padding-box;\n\tcolor:#424242;\n}\n\n.jscGrid table td.summaryCell{\n\tcolor: #999;\n}\n\n.jscGrid .exportButton{\n\tmargin: 10px auto;\n\tdisplay: block;\n\tpadding: 6px 18px;\n\tcursor: pointer;\n\tbackground-color: #0277BD;\n\tcolor:white;\n\tborder-width: 0px;\n\tborder-radius: 3px;\n}\n\n.jscGrid .exportButton:hover{\n\tbox-shadow: 0 2px 4px rgba(0,0,0,.1);\n}\n.jscGrid .exportButton:active{\n\tbox-shadow: 0 0 6px rgba(0,0,0,.2) inset;\n}\n.jscGrid .exportButton:focus{\n\toutline: none;\n}\n\n.chartGridSwitch {\n\tmargin: 8px 0;\n\ttext-align: center;\n}\n\n.chartGridSwitch button{\n\tborder: 1px solid gray;\n\tpadding: 4px 8px;\n\tcursor: pointer;\n\tmargin-left: 0px;\n\tmargin-right: 0px;\n}\n\n.chartGridSwitch .gridButton{\n\tborder-top-right-radius: 4px;\n\tborder-bottom-right-radius: 4px;\n\tborder-left-width: 0px;\n\tbackground-color: #F5F5F5;\n}\n\n.chartGridSwitch .chartButton{\n\tborder-top-left-radius: 4px;\n\tborder-bottom-left-radius: 4px;\n\tbackground-color: #D5D5D5;\n}\n\n.chartGridSwitch button:focus{\n\toutline: none;\n}\n",
"datagridStyleDefault"),e.updateScrollMeta());g.cssFile&&T(function(){e.updateScrollMeta()},g.cssFile);return e}r(a,c);a.prototype.prerender=function(){var b=d.platform.doc.createElement("div");b.classList.add("clusterize-scroll");b.classList.add("jscGrid");b.style.overflow="auto";b.setAttribute("id","tableWrapper");this.wrapper=new d.VirtualElement(b,this.renderer)};a.prototype.initFP=function(){var b=this,a=function(b,a){var c=a;d.jL.isString(a)&&(c=b.indexOf(a),-1<c||(a=parseInt(a),c=0<=a&&a<b.length?
a:void 0));return c};this.column=function(c){if(void 0===c)return[];var e=b._dataObj,f=e[0],h=a(f,c);return 0<=h&&h<f.length?(c=d.jL.map(e,function(b){return b[h]}),!1!==b.currentOptions.headerRow&&c.shift(),c):[]};this.cells=function(c){if(!c)return[];var e=d.jL.isNumber(c)?[c]:c.split(":");if(1===e.length)return b.column(e[0]);var f=b._dataObj[0];c=[];var h=a(f,e[1]);for(e=a(f,e[0]);e<=h;)c.push(b.column(e++));return c}};a.prototype.normalizeOptions=function(b,a){return d.jL.expandOptionsProperties(b,
a||"data")};a.prototype.register=function(){u.add(this,this.element)};a.prototype.options=function(b,a){c.prototype.options.call(this,b);var e=this.optionsGetter(b);if("NotGetter"!==e)return e;if(!this.data||!this.data.length||b.data||b.summaryRow)this.data=this.dataRows(b||K(this.chart)),this.rowLen=this.data.length;b=this.data&&this.data.length;!1!==a&&b&&(this.setColDefs(),this.render());return this};a.prototype.setColDefs=function(){var b=this.currentOptions,a=b.defaultColumn,c=this.userOptions.columns||
[];if(c.length){c="string"===typeof c[0]?b.columns=c.map(function(b){return b.substr?{value:b}:b}):c.map(function(b){return d.jL.merge({},b)});var k=c.length}else k=G(this),d.jL.times(k,function(b){return c.push({})});a&&d.jL.isObject(a)&&(c=c.map(function(b){return d.jL.merge(d.jL.copy(a),b)}));var g=b.colWidths,h=b.headers,m=(b=b.types)&&b.length,n=g&&g.length;if(d.jL.evalPath(h,"0.length")){this._headerCount=h.length;for(var p=function(b){var a=[];d.jL.times(h.length,function(c){a.push(h[c][b])});
c[b].header=a},l=0;l<k;l++)p(l)}for(l=0;l<c.length;l++)k=c[l],n&&(k.width=d.jL.pick(c.width,g[l])),m&&(k.type=b[l]),k.type&&!k.align&&(k.align=ba[k.type]);this._colDefs=c;return this};a.prototype.defaultOptions=function(){return{cultureName:"en-US",headerRow:!0,headerCol:!1,width:"100%"}};a.renderIn=function(b,c){b=new a(b,c);b.render();return b};a.prototype.render=function(){var b=this,a=b.currentOptions,c=b._colDefs,k=c.length,g=R(b),h=b.rowLen||b.data.length,m=!!a.summaryRow,n=a.headerCol,p=n?
1:0,l=a.headerRow&&g.length?b._headerCount||1:0;b._renderRow=void 0;b._itemsRendered=0;b._dataObj=[];var q=function(b,a,c){var e=a.width;b.className=a.className||"col"+c;a.align&&(b.style.textAlign=a.align);d.jL.def(e)&&(b.style.width=e+(d.jL.isNumber(e)?"px":""))},r=function(b,a,d){var e=document.createElement("th");q(e,c[d]||{},d);e.appendChild(z(a));b.appendChild(e);return e},v=["chart","icon","img"],z=function(b){var a;b=b||"";d.jL.each(v,function(c){b&&-1<b.indexOf("<"+c)&&!a&&(a=document.createElement("div"),
d.jscLabel(a,b))});return a||document.createTextNode(b)},t=b.wrapper;200<h?(a.height=a.height||600,!b._subscribedToScroll&&t.on("scroll",b.scrollHandler),b._subscribedToScroll=!0):(b._subscribedToScroll&&t.un("scroll",b.scrollHandler),b._subscribedToScroll=!1);d.jL.isDefined(a.height)&&t.attr({height:a.height});d.jL.isDefined(a.width)&&t.attr({width:a.width});b.table&&b.table.destroy();b.exportButton&&b.exportButton.destroy();var u=b.table=b.renderer.element("table",{className:a.className,id:a.id},
"html");b.thead=u.el.createTHead();l&&d.jL.times(l,function(a){a=g[a];b._dataObj.push(a);var c=b.thead.insertRow();p&&r(c,"",-1);d.jL.each(a,function(b,a){return r(c,b,a)})});l=Math.min(h,200);var w=u.el.createTBody();2E3<l&&w.classList.add("clusterize-content");w.setAttribute("id","tableBody");for(var x=b._renderRow=function(a,e){var f=O(b,a);b._dataObj.push(f);for(var g=w.insertRow(),h=0,l=k+p;h<l;h++)if(!h&&n)r(g,a+1+"",h-p);else{var m=f[h-p],t=h-p,u=e,v=g.insertCell();u=d.jL.extend(u||{},c[t]);
q(v,u,t);v.appendChild(z(m))}b.rowsStrings.push(g.outerHTML)},y={className:"summaryCell"},A=0;A<l;A++)x(A,m&&A===l-1?y:void 0);b._itemsRendered=l;b._itemsCount=h;u.add(b.wrapper);b.element.appendChild(t.el);a.exportFile&&(a=void 0,b.exportButton=a=b.renderer.element("input",{type:"button",class:"exportButton",value:b.buttonText("export")||"Download CSV"},"html"),a.on("click",function(){return U("datagrid.csv",b._dataObj)}),a.add(b.wrapper));b.updateScrollMeta();b.isRendered=!0;L(b);return b};a.prototype.updateScrollMeta=
function(){!this.isDestroyed&&this.table&&(this._scrollMeta={scrollHeight:this.table.el.scrollHeight,viewHeight:this.wrapper.el.clientHeight})};a.prototype.scroll=function(b){b=this._scrollMeta;if(0>b.scrollHeight-this.wrapper.el.scrollTop-5*b.viewHeight/4){b=Math.min(this._itemsCount,this._itemsRendered+200);for(var a=this._itemsRendered;a<b;a++)this._renderRow(a),this._itemsRendered++;2E3<this._itemsRendered&&(this.clusterize&&this.clusterize.destroy(),this.clusterize=new C({rows:this.rowsStrings,
scrollId:"tableWrapper",contentId:"tableBody"}));this.updateScrollMeta()}};a.prototype.setDataFromChart=function(b){var a=this.userOptions.columns||ca(this.chart.series(0));this.options({data:K(this.chart),columns:a},b)};a.prototype.destroy=function(){u.remove(this);this.wrapper&&this.wrapper.destroy();this.table&&this.table.destroy();this.isDestroyed=!0};a.prototype.dispose=function(){this.destroy()};a.prototype.buttonText=function(b){return d.jL.evalPath(this.currentOptions,"buttons."+b+".text")};
a.prototype.dataRows=function(b){var a=b.data;if(!a||!d.jL.isArray(a)){var c=b.data||b;d.jL.isFunction(c)&&(c=c());a=[];for(var k=0,g=void 0;g=c[k++];)a.push(g)}!a.length&&this.data&&(a=this.data);b=b.summaryRow||this.userOptions.summaryRow;var h=("function"===typeof a?a():a)||[];b&&(a=d.jL.isArray(b)&&d.jL.isObject(b[0])?b:[b],d.jL.map(a,function(a){return h.push(a)}));return h};return a}(J),K=function(c){return c&&function(){var a=[];c.series().each(function(b){b.points().each(function(b){return a.push(b)})});
return a}},ca=function(c){var a=c.info.labelTextInfo,b=c.chart.series().items.length,d={time:"date",category:"string",number:"number"},f=[];c=function(a,b,c){void 0===c&&(c=void 0);return f.push({header:a,value:b,type:c})};a.sName&&1<b&&c("Series","%seriesName");a.hasX&&c(a.xAxisLabel||("time"===a.xScale?"Date":"X"),"%xValue",d[a.xScale]||void 0);b=a.yAxisLabel||"Y";a.hasRange?(c(b+" Low","%low",d[a.vScale]),c(b+" High","%high",d[a.vScale])):c(b,"%yValue",d[a.vScale]);d=a.zAxisLabel||"Z";a.hasZ&&
c(d,"%zValue");return f};(function(){d.moduleLoader.registerModule("modules/datagrid");d.registerDataGridFunction("chartToGrid",N);d.registerDataGridFunction("createGridSwitch",V);d.registerDataGridFunction("gridConstructor",function(c,a,b){return new F(c,a,b)})})()})(JSC.internal._modules.datagrid.externals);
